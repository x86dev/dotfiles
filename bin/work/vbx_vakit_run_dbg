#!/bin/sh

. ${HOME}/.functions.work

__vbx_vakit_env "$MY_VBOX_BRANCH"

MY_VM_NAME=${1}
MY_TESTS=${2}

if [ -z "$MY_VM_NAME" ]; then
    echo "Must specify a test VM name."
    exit 1
fi

if [ -z "$MY_TESTS" ]; then
    MY_TESTS=all
fi

# Make sure no VBoxSVC is around anymore.
vbx_kill

# Start the test driver with debug arguments.
# Note: Needs xterm installed!
( cd ${MY_VBOX_PATH_ROOT}/src/VBox/ValidationKit/tests/additions && \
    python tdAddGuestCtrl.py ${VBOX_VALIDATIONKIT_TESTDRIVER_DEFAULT_OPTS} \
    --test-vms ${MY_VM_NAME} --vbox-svc-debug --snapshot-restore-current --no-wipe-clean --add-guest-ctrl-tests ${MY_TESTS} cleanup-before verify config execute )
